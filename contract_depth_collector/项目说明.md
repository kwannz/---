# 多交易所合约铺单量数据收集器 - 项目说明

## 项目概述

本项目是一个专门用于收集多个主流加密货币交易所合约深度数据（铺单量）的Python工具。通过实时采集各交易所的订单簿数据，为量化交易、市场分析等提供数据支持。

## 核心功能

### 1. 多交易所支持
- **Binance（币安）** - 全球最大的加密货币交易所
- **MEXC** - 新兴的加密货币交易平台
- **Gate.io（芝麻开门）** - 老牌加密货币交易所
- **OKX（欧易）** - 知名加密货币衍生品交易所
- **BingX** - 新兴的加密货币交易平台
- **Bitunix** - 加密货币合约交易平台
- **Blofin** - 加密货币衍生品交易平台

### 2. 数据收集方式
- **REST API** - 通过HTTP请求获取深度数据
- **WebSocket** - 实时数据流，支持高频更新
- **自动重连** - 网络中断时自动重连
- **错误处理** - 完善的异常处理机制

### 3. 数据处理功能
- **实时分析** - 计算价差、成交量等指标
- **数据存储** - 自动保存为JSON和CSV格式
- **统计分析** - 提供详细的统计报告
- **多格式导出** - 支持多种数据格式

## 技术架构

### 1. 模块化设计
```
contract_depth_collector/
├── main.py                 # 主程序入口
├── run.py                  # 启动脚本
├── config/                 # 配置管理
├── exchanges/             # 交易所模块
├── utils/                 # 工具模块
├── data/                  # 数据存储
└── logs/                  # 日志文件
```

### 2. 异步编程
- 使用 `asyncio` 实现异步并发
- 支持同时连接多个交易所
- 高效的资源利用

### 3. 配置管理
- JSON格式配置文件
- 支持API密钥管理
- 灵活的参数设置

## 使用方法

### 1. 快速开始
```bash
# 安装依赖
pip install -r requirements.txt

# 运行程序
python run.py
```

### 2. 配置设置
编辑 `config/settings.json` 文件：
```json
{
  "exchanges": {
    "binance": {
      "enabled": true,
      "api_key": "your_api_key",
      "secret_key": "your_secret_key"
    }
  }
}
```

### 3. 程序化使用
```python
from main import ContractDepthCollector

collector = ContractDepthCollector()
await collector.collect_depth_data(['BTCUSDT', 'ETHUSDT'], duration=3600)
```

## 数据格式

### 深度数据结构
```python
@dataclass
class DepthData:
    exchange: str              # 交易所名称
    symbol: str               # 交易对符号
    timestamp: float          # 时间戳
    bids: List[List[float]]   # 买盘数据
    asks: List[List[float]]   # 卖盘数据
    spread: float             # 价差
    total_bid_volume: float   # 买盘总量
    total_ask_volume: float   # 卖盘总量
```

### 分析指标
- **价差 (Spread)** - 最优买卖价差
- **中间价 (Mid Price)** - 买卖盘中间价格
- **成交量不平衡** - 买卖盘成交量差异
- **价格冲击** - 大单对价格的影响
- **订单簿压力** - 买卖盘压力对比

## API接口说明

### Binance
- **REST**: `GET /fapi/v1/depth`
- **WebSocket**: `wss://fstream.binance.com/ws/{symbol}@depth@100ms`

### MEXC
- **REST**: `GET /api/v1/contract/depth`
- **WebSocket**: `wss://contract.mexc.com/ws/contract@public.deals@{symbol}`

### Gate.io
- **REST**: `GET /api/v4/futures/usdt/order_book`
- **WebSocket**: `wss://fx-ws.gateio.ws/v4/ws/usdt`

### OKX
- **REST**: `GET /api/v5/market/books`
- **WebSocket**: `wss://ws.okx.com:8443/ws/v5/public`

### BingX
- **REST**: `GET /openApi/swap/v2/quote/depth`
- **WebSocket**: `wss://open-api-ws.bingx.com/market`

### Bitunix
- **REST**: `GET /api/v1/market/depth`
- **WebSocket**: `wss://ws.bitunix.com`

### Blofin
- **REST**: `GET /api/v1/market/depth`
- **WebSocket**: `wss://open-api-ws.blofin.com/public`

## 注意事项

### 1. API限制
- 各交易所都有API调用频率限制
- 建议合理设置收集间隔
- 避免频繁请求导致IP被封

### 2. 网络要求
- 需要稳定的网络连接
- 建议使用VPS或云服务器
- 程序会自动重连，但网络质量影响数据完整性

### 3. 数据存储
- 数据会定期自动保存
- 建议定期备份数据文件
- 注意磁盘空间使用情况

### 4. 安全考虑
- API密钥请妥善保管
- 建议使用只读权限的API密钥
- 定期更换API密钥

## 扩展功能

### 1. 自定义分析
- 可以继承 `DataProcessor` 类
- 添加自定义分析指标
- 实现特定的数据处理逻辑

### 2. 新交易所支持
- 继承 `BaseCollector` 类
- 实现特定的API接口
- 添加配置支持

### 3. 数据可视化
- 可以集成matplotlib等可视化库
- 实时显示深度数据图表
- 生成分析报告

## 故障排除

### 常见问题
1. **连接失败** - 检查网络和API配置
2. **数据为空** - 确认交易对符号正确
3. **频繁断线** - 调整重连参数
4. **内存占用高** - 调整数据保存频率

### 日志分析
```bash
# 查看实时日志
tail -f logs/collector.log

# 查看错误日志
grep "ERROR" logs/collector.log
```

## 性能优化

### 1. 并发控制
- 合理设置并发连接数
- 避免过多同时连接
- 监控系统资源使用

### 2. 内存管理
- 定期清理历史数据
- 使用数据压缩
- 优化数据结构

### 3. 网络优化
- 使用CDN加速
- 选择就近的服务器
- 优化网络配置

## 未来计划

1. **更多交易所支持** - 添加更多主流交易所
2. **数据可视化** - 集成实时图表功能
3. **机器学习** - 添加预测分析功能
4. **Web界面** - 开发Web管理界面
5. **数据库支持** - 支持MySQL、MongoDB等数据库

## 技术支持

如有问题或建议，请通过以下方式联系：
- 提交Issue到项目仓库
- 发送邮件反馈
- 参与社区讨论

## 许可证

本项目采用MIT许可证，详见LICENSE文件。

---

**注意**: 本项目仅供学习和研究使用，请遵守各交易所的使用条款和相关法律法规。
